/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
/**
 * @record
 */
export function RequestCacheEntry() { }
if (false) {
    /** @type {?} */
    RequestCacheEntry.prototype.url;
    /** @type {?} */
    RequestCacheEntry.prototype.response;
    /** @type {?} */
    RequestCacheEntry.prototype.lastRead;
}
/**
 * @abstract
 */
var /**
 * @abstract
 */
RequestCache = /** @class */ (function () {
    function RequestCache() {
    }
    return RequestCache;
}());
/**
 * @abstract
 */
export { RequestCache };
if (false) {
    /**
     * @abstract
     * @param {?} req
     * @return {?}
     */
    RequestCache.prototype.get = function (req) { };
    /**
     * @abstract
     * @param {?} req
     * @param {?} response
     * @return {?}
     */
    RequestCache.prototype.put = function (req, response) { };
}
/** @type {?} */
var maxAge = 30000;
// maximum cache age (ms)
var RequestCacheWithMap = /** @class */ (function () {
    function RequestCacheWithMap() {
        this.cache = new Map();
    }
    /**
     * @param {?} req
     * @return {?}
     */
    RequestCacheWithMap.prototype.get = /**
     * @param {?} req
     * @return {?}
     */
    function (req) {
        /** @type {?} */
        var url = req.urlWithParams;
        /** @type {?} */
        var cached = this.cache.get(url);
        if (!cached) {
            return undefined;
        }
        return cached.response;
    };
    /**
     * @param {?} req
     * @param {?} response
     * @return {?}
     */
    RequestCacheWithMap.prototype.put = /**
     * @param {?} req
     * @param {?} response
     * @return {?}
     */
    function (req, response) {
        var _this = this;
        /** @type {?} */
        var url = req.urlWithParams;
        /** @type {?} */
        var entry = { url: url, response: response, lastRead: Date.now() };
        this.cache.set(url, entry);
        // remove expired cache entries
        /** @type {?} */
        var expired = Date.now() - maxAge;
        this.cache.forEach(function (entry) {
            if (entry.lastRead < expired) {
                _this.cache.delete(entry.url);
            }
        });
    };
    RequestCacheWithMap.decorators = [
        { type: Injectable }
    ];
    return RequestCacheWithMap;
}());
export { RequestCacheWithMap };
if (false) {
    /** @type {?} */
    RequestCacheWithMap.prototype.cache;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FjaGUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BuZ3gtZ2FsbGVyeS9jb3JlLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL2NhY2hlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7Ozs7QUFHM0MsdUNBSUM7OztJQUhDLGdDQUFZOztJQUNaLHFDQUE0Qjs7SUFDNUIscUNBQWlCOzs7OztBQUduQjs7OztJQUFBO0lBSUEsQ0FBQztJQUFELG1CQUFDO0FBQUQsQ0FBQyxBQUpELElBSUM7Ozs7Ozs7Ozs7O0lBSEMsZ0RBQW1FOzs7Ozs7O0lBRW5FLDBEQUF1RTs7O0lBR25FLE1BQU0sR0FBRyxLQUFLOztBQUVwQjtJQUFBO1FBRUUsVUFBSyxHQUFHLElBQUksR0FBRyxFQUE2QixDQUFDO0lBMEIvQyxDQUFDOzs7OztJQXhCQyxpQ0FBRzs7OztJQUFILFVBQUksR0FBcUI7O1lBQ2pCLEdBQUcsR0FBRyxHQUFHLENBQUMsYUFBYTs7WUFDdkIsTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztRQUVsQyxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ1gsT0FBTyxTQUFTLENBQUM7U0FDbEI7UUFDRCxPQUFPLE1BQU0sQ0FBQyxRQUFRLENBQUM7SUFDekIsQ0FBQzs7Ozs7O0lBRUQsaUNBQUc7Ozs7O0lBQUgsVUFBSSxHQUFxQixFQUFFLFFBQTJCO1FBQXRELGlCQWFDOztZQVpPLEdBQUcsR0FBRyxHQUFHLENBQUMsYUFBYTs7WUFFdkIsS0FBSyxHQUFHLEVBQUMsR0FBRyxLQUFBLEVBQUUsUUFBUSxVQUFBLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBQztRQUNuRCxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7OztZQUdyQixPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLE1BQU07UUFDbkMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBQyxLQUFVO1lBQzVCLElBQUksS0FBSyxDQUFDLFFBQVEsR0FBRyxPQUFPLEVBQUU7Z0JBQzVCLEtBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUM5QjtRQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQzs7Z0JBM0JGLFVBQVU7O0lBNEJYLDBCQUFDO0NBQUEsQUE1QkQsSUE0QkM7U0EzQlksbUJBQW1COzs7SUFDOUIsb0NBQTZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBIdHRwUmVxdWVzdCwgSHR0cFJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0Q2FjaGVFbnRyeSB7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgcmVzcG9uc2U6IEh0dHBSZXNwb25zZTxhbnk+O1xyXG4gIGxhc3RSZWFkOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBSZXF1ZXN0Q2FjaGUge1xyXG4gIGFic3RyYWN0IGdldChyZXE6IEh0dHBSZXF1ZXN0PGFueT4pOiBIdHRwUmVzcG9uc2U8YW55PiB8IHVuZGVmaW5lZDtcclxuXHJcbiAgYWJzdHJhY3QgcHV0KHJlcTogSHR0cFJlcXVlc3Q8YW55PiwgcmVzcG9uc2U6IEh0dHBSZXNwb25zZTxhbnk+KTogdm9pZDtcclxufVxyXG5cclxuY29uc3QgbWF4QWdlID0gMzAwMDA7IC8vIG1heGltdW0gY2FjaGUgYWdlIChtcylcclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFJlcXVlc3RDYWNoZVdpdGhNYXAgaW1wbGVtZW50cyBSZXF1ZXN0Q2FjaGUge1xyXG4gIGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIFJlcXVlc3RDYWNoZUVudHJ5PigpO1xyXG5cclxuICBnZXQocmVxOiBIdHRwUmVxdWVzdDxhbnk+KTogSHR0cFJlc3BvbnNlPGFueT4gfCB1bmRlZmluZWQge1xyXG4gICAgY29uc3QgdXJsID0gcmVxLnVybFdpdGhQYXJhbXM7XHJcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLmNhY2hlLmdldCh1cmwpO1xyXG5cclxuICAgIGlmICghY2FjaGVkKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2FjaGVkLnJlc3BvbnNlO1xyXG4gIH1cclxuXHJcbiAgcHV0KHJlcTogSHR0cFJlcXVlc3Q8YW55PiwgcmVzcG9uc2U6IEh0dHBSZXNwb25zZTxhbnk+KTogdm9pZCB7XHJcbiAgICBjb25zdCB1cmwgPSByZXEudXJsV2l0aFBhcmFtcztcclxuXHJcbiAgICBjb25zdCBlbnRyeSA9IHt1cmwsIHJlc3BvbnNlLCBsYXN0UmVhZDogRGF0ZS5ub3coKX07XHJcbiAgICB0aGlzLmNhY2hlLnNldCh1cmwsIGVudHJ5KTtcclxuXHJcbiAgICAvLyByZW1vdmUgZXhwaXJlZCBjYWNoZSBlbnRyaWVzXHJcbiAgICBjb25zdCBleHBpcmVkID0gRGF0ZS5ub3coKSAtIG1heEFnZTtcclxuICAgIHRoaXMuY2FjaGUuZm9yRWFjaCgoZW50cnk6IGFueSkgPT4ge1xyXG4gICAgICBpZiAoZW50cnkubGFzdFJlYWQgPCBleHBpcmVkKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUoZW50cnkudXJsKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==